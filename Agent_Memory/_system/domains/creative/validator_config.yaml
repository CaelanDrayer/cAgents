# Creative Domain Validator Configuration
# Quality gates and validation rules for creative writing deliverables

domain: creative
version: 1.0
description: "Validation and quality gates for creative writing, storytelling, and narrative development"

# Quality Gates
# Critical checks that must pass for creative deliverables

quality_gates:
  completeness:
    severity: critical
    description: "All required story elements and components present"
    checks:
      - name: "All planned scenes/chapters written"
        applicable_to: [write_scene, write_novel_chapter_arc, write_full_novel]
        pass_criteria: "Every scene in outline has been written"
        fixable: true
        fix_agent: prose-stylist

      - name: "All characters developed"
        applicable_to: [develop_character, write_full_novel]
        pass_criteria: "Character profiles complete for all major characters"
        fixable: true
        fix_agent: character-designer

      - name: "Worldbuilding elements defined"
        applicable_to: [design_world, write_full_novel]
        pass_criteria: "All necessary world elements (magic, geography, culture) defined"
        fixable: true
        fix_agent: worldbuilder

      - name: "Plot threads resolved"
        applicable_to: [write_novel_chapter_arc, write_full_novel]
        pass_criteria: "Major plot threads reach resolution (or intentional cliffhanger)"
        fixable: true
        fix_agent: plot-developer

  narrative_quality:
    severity: major
    description: "Story quality, engagement, and craft"
    checks:
      - name: "Prose quality professional"
        applicable_to: [write_scene, write_novel_chapter_arc, write_full_novel]
        pass_criteria: "Prose is engaging, vivid, and well-crafted"
        fixable: true
        fix_agent: prose-stylist
        validation_method: "Manual review for engagement and quality"

      - name: "Pacing appropriate"
        applicable_to: [write_scene, write_novel_chapter_arc, write_full_novel]
        pass_criteria: "Story pacing maintains reader engagement without dragging or rushing"
        fixable: true
        fix_agent: editor

      - name: "Character voices distinct"
        applicable_to: [write_scene, write_novel_chapter_arc, write_full_novel]
        pass_criteria: "Each character has recognizable voice and speech patterns"
        fixable: true
        fix_agent: dialogue-specialist

      - name: "Scenes show don't tell"
        applicable_to: [write_scene, write_novel_chapter_arc]
        pass_criteria: "Emotion and action shown through scene, not exposition"
        fixable: true
        fix_agent: editor

  story_logic:
    severity: critical
    description: "Internal consistency and logical coherence"
    checks:
      - name: "No plot holes"
        applicable_to: [write_novel_chapter_arc, write_full_novel, outline_plot]
        pass_criteria: "Plot events follow logically, no unexplained gaps"
        fixable: true
        fix_agent: continuity-checker

      - name: "No character inconsistencies"
        applicable_to: [develop_character, write_scene, write_novel_chapter_arc, write_full_novel]
        pass_criteria: "Characters act consistently with established personality and motivation"
        fixable: true
        fix_agent: continuity-checker

      - name: "No timeline errors"
        applicable_to: [write_novel_chapter_arc, write_full_novel]
        pass_criteria: "Events occur in logical sequence, no impossible timelines"
        fixable: true
        fix_agent: continuity-checker

      - name: "World rules consistent"
        applicable_to: [design_world, write_full_novel]
        pass_criteria: "Magic/tech/world rules applied consistently"
        fixable: true
        fix_agent: worldbuilder

  technical_polish:
    severity: major
    description: "Grammar, spelling, formatting correctness"
    checks:
      - name: "No grammar errors"
        applicable_to: all
        pass_criteria: "Grammatically correct throughout"
        fixable: true
        fix_agent: copy-editor

      - name: "No spelling errors"
        applicable_to: all
        pass_criteria: "All words spelled correctly (or intentional dialect)"
        fixable: true
        fix_agent: copy-editor

      - name: "Proper formatting"
        applicable_to: all
        pass_criteria: "Consistent formatting, proper paragraph breaks, dialogue formatting"
        fixable: true
        fix_agent: copy-editor

      - name: "Punctuation correct"
        applicable_to: all
        pass_criteria: "Punctuation used correctly throughout"
        fixable: true
        fix_agent: copy-editor

  structural_integrity:
    severity: major
    description: "Story structure and narrative flow"
    checks:
      - name: "Clear story structure"
        applicable_to: [write_novel_chapter_arc, write_full_novel, outline_plot]
        pass_criteria: "Story follows coherent structure (three-act, hero's journey, etc.)"
        fixable: true
        fix_agent: story-architect

      - name: "Scenes serve purpose"
        applicable_to: [write_scene, write_novel_chapter_arc, write_full_novel]
        pass_criteria: "Every scene advances plot or develops character"
        fixable: true
        fix_agent: editor

      - name: "Transitions smooth"
        applicable_to: [write_novel_chapter_arc, write_full_novel]
        pass_criteria: "Transitions between scenes and chapters flow naturally"
        fixable: true
        fix_agent: narrative-designer

  character_depth:
    severity: major
    description: "Character development and authenticity"
    checks:
      - name: "Characters multi-dimensional"
        applicable_to: [develop_character, write_full_novel]
        pass_criteria: "Characters have depth, not one-dimensional or stereotyped"
        fixable: true
        fix_agent: character-psychologist

      - name: "Motivations clear"
        applicable_to: [develop_character, write_full_novel]
        pass_criteria: "Character motivations and goals are understandable"
        fixable: true
        fix_agent: character-designer

      - name: "Character arcs present"
        applicable_to: [write_full_novel]
        pass_criteria: "Major characters undergo growth or change"
        fixable: true
        fix_agent: character-designer

  worldbuilding_coherence:
    severity: major
    description: "World consistency and plausibility"
    checks:
      - name: "World internally consistent"
        applicable_to: [design_world, write_full_novel]
        pass_criteria: "World elements don't contradict each other"
        fixable: true
        fix_agent: worldbuilder

      - name: "World serves story"
        applicable_to: [design_world]
        pass_criteria: "World elements enhance rather than overwhelm story"
        fixable: true
        fix_agent: worldbuilder

      - name: "Magic/tech rules clear"
        applicable_to: [design_world]
        when: "magic_system or technology_system present"
        pass_criteria: "Rules and limitations of systems clearly defined"
        fixable: true
        fix_agent: worldbuilder

# Validation Rules
# Domain-specific validation logic for creative work

validation_rules:
  write_scene_validation:
    applicable_to: [write_scene]
    required_components:
      - "Scene has clear purpose (plot advancement or character development)"
      - "Setting established (where and when)"
      - "POV character identified"
      - "Conflict or tension present"
      - "Sensory details included"
      - "Dialogue sounds authentic (if present)"
      - "Scene ends with hook or resolution"
    quality_requirements:
      - "Prose engages reader"
      - "Show don't tell principle applied"
      - "No grammar or spelling errors"
    word_count_check:
      typical_range: "1000-3000 words for single scene"
      adjustable: true

  develop_character_validation:
    applicable_to: [develop_character]
    required_components:
      - "Physical appearance described"
      - "Personality traits defined"
      - "Backstory provided"
      - "Motivations and goals clear"
      - "Flaws and weaknesses identified"
      - "Character voice described"
      - "Character arc outlined (if applicable)"
    quality_requirements:
      - "Character feels multi-dimensional"
      - "Avoids stereotypes"
      - "Motivations believable"
      - "Character fits story world"

  design_world_validation:
    applicable_to: [design_world]
    required_components:
      - "Core world concept defined"
      - "Geography established (if relevant)"
      - "Culture/society defined (if relevant)"
      - "Magic or technology system (if applicable)"
      - "History and lore (appropriate depth)"
      - "Rules and limitations clear"
    quality_requirements:
      - "World internally consistent"
      - "World serves story, doesn't overwhelm"
      - "Sufficient detail without info-dumping"
      - "Unique elements or fresh take on familiar concepts"

  outline_plot_validation:
    applicable_to: [outline_plot]
    required_components:
      - "Beginning/inciting incident identified"
      - "Major plot points defined"
      - "Midpoint turn or escalation"
      - "Climax identified"
      - "Resolution defined"
      - "Subplots integrated (if applicable)"
      - "Character arcs aligned with plot"
    quality_requirements:
      - "Plot logically coherent"
      - "Pacing varied (action/tension and rest)"
      - "Stakes escalate appropriately"
      - "Satisfying structure for story type"

  edit_manuscript_validation:
    applicable_to: [edit_manuscript]
    required_components:
      - "Structural issues addressed"
      - "Pacing improved"
      - "Character consistency verified"
      - "Plot holes fixed"
      - "Prose quality enhanced"
      - "Technical errors corrected"
    quality_requirements:
      - "Manuscript reads smoothly"
      - "Improvements measurable vs original"
      - "No new errors introduced"
      - "Editorial vision clear"

  write_novel_chapter_arc_validation:
    applicable_to: [write_novel_chapter_arc]
    required_components:
      - "All planned chapters written"
      - "Arc has clear beginning, middle, end"
      - "Pacing appropriate across arc"
      - "Character development within arc"
      - "Plot threads advanced or resolved"
      - "Continuity maintained across chapters"
      - "Transitions between chapters smooth"
    quality_requirements:
      - "Arc feels cohesive, not episodic"
      - "Reader engagement maintained throughout"
      - "Prose quality consistent"
      - "Technical polish complete"
    word_count_check:
      typical_range: "15000-30000 words for multi-chapter arc"
      adjustable: true

  write_full_novel_validation:
    applicable_to: [write_full_novel]
    required_components:
      - "Complete three-act structure (or appropriate structure)"
      - "All plot threads resolved or set up for sequel"
      - "Character arcs complete"
      - "World consistently portrayed"
      - "No plot holes or major inconsistencies"
      - "Professional prose throughout"
      - "Technical polish (grammar, spelling, formatting)"
      - "Continuity verified across full manuscript"
    quality_requirements:
      - "Engaging from beginning to end"
      - "Pacing maintains reader interest"
      - "Themes explored coherently"
      - "Satisfying ending"
      - "Ready for professional publication consideration"
    word_count_check:
      typical_range: "50000-120000 words"
      genre_adjustments:
        literary_fiction: "60000-100000"
        commercial_fiction: "70000-100000"
        fantasy: "90000-120000"
        scifi: "80000-110000"
        mystery: "70000-90000"
        romance: "70000-100000"

# Classification Criteria
# How to classify validation outcomes for creative work

classification:
  PASS:
    description: "Creative work meets quality standards, ready for delivery or publication"
    criteria:
      all_critical_passed: true
      all_major_passed: true
      minor_issues_count: "<= 3"
      narrative_quality: "engaging and professional"
    next_action: "Mark instruction as completed"

  FIXABLE:
    description: "Issues found but can be corrected without human creative direction"
    criteria:
      any_critical_failed: true
      OR:
      major_quality_issues: true
      issue_types: [technical_errors, continuity_errors, incomplete_elements, pacing_issues]
      fixable: true
      retry_count: "< max_retries"
    next_action: "Send to self-correct agent"
    common_fixable_issues:
      - "Grammar, spelling, or formatting errors"
      - "Plot holes or continuity errors"
      - "Missing story elements (scenes, character details, worldbuilding)"
      - "Pacing issues (too fast or too slow)"
      - "Dialogue needs polish"
      - "Prose quality below professional standard"
      - "Character voices too similar"
      - "Weak scene transitions"

  BLOCKED:
    description: "Cannot proceed without human creative judgment"
    criteria:
      fundamental_story_issue: true
      OR:
      creative_direction_needed: true
      OR:
      retry_count: ">= max_retries"
    next_action: "Escalate to HITL"
    common_blocking_issues:
      - "Fundamental plot doesn't work"
      - "Characters lack depth despite revision attempts"
      - "Story lacks conflict or stakes"
      - "Tone or voice unclear or inconsistent"
      - "Creative vision needs human guidance"
      - "Sensitivity concerns require human judgment"
      - "Self-correction attempts exhausted"
      - "Story stuck at fundamental level"

# Automated Validation Checks
# Checks that can be run automatically on creative work

automated_checks:
  word_count:
    description: "Verify deliverable meets target word count"
    command: "wc -w {output_file}"
    pass_criteria_by_type:
      write_scene: ">= 800 words"
      write_novel_chapter_arc: ">= 10000 words"
      write_full_novel: ">= 50000 words AND <= 150000 words"
    fixable: true
    note: "Word count targets are guidelines, not hard rules"

  spell_check:
    description: "Identify spelling errors"
    command: "aspell list < {output_file}"
    pass_criteria: "No misspellings (excluding proper nouns and intentional dialect)"
    fixable: true
    severity: major

  dialogue_formatting:
    description: "Check dialogue uses proper quotation marks and formatting"
    command: "grep -E '\"[^\"]+\"' {output_file}"
    pass_criteria: "All dialogue properly formatted with quotes"
    fixable: true
    severity: minor

  paragraph_breaks:
    description: "Verify adequate paragraph breaks for readability"
    validation_method: "Manual check that paragraphs not excessively long (>500 words)"
    pass_criteria: "Paragraphs reasonably sized, not wall of text"
    fixable: true
    severity: minor

  file_format:
    description: "Verify output in correct format"
    applicable_to: all
    expected_formats: [".txt", ".md", ".docx"]
    pass_criteria: "File in expected format"
    fixable: false
    severity: critical

# Manual Validation Checklist
# Items requiring human/AI creative judgment

manual_validation_checklist:
  prose_engagement:
    question: "Does the prose draw the reader in and maintain engagement?"
    applicable_to: [write_scene, write_novel_chapter_arc, write_full_novel]
    severity: critical

  character_authenticity:
    question: "Do characters feel real and multi-dimensional?"
    applicable_to: [develop_character, write_novel_chapter_arc, write_full_novel]
    severity: major

  plot_coherence:
    question: "Does the plot make sense with no major holes?"
    applicable_to: [outline_plot, write_novel_chapter_arc, write_full_novel]
    severity: critical

  pacing_appropriate:
    question: "Is the pacing well-balanced, maintaining interest without rushing?"
    applicable_to: [write_scene, write_novel_chapter_arc, write_full_novel]
    severity: major

  world_serves_story:
    question: "Does worldbuilding enhance rather than overwhelm the story?"
    applicable_to: [design_world, write_full_novel]
    severity: major

  dialogue_authentic:
    question: "Does dialogue sound natural and reveal character?"
    applicable_to: [write_scene, write_novel_chapter_arc, write_full_novel]
    severity: major

  emotional_resonance:
    question: "Do emotional moments land with appropriate impact?"
    applicable_to: [write_scene, write_novel_chapter_arc, write_full_novel]
    severity: major

  ending_satisfying:
    question: "Does the ending feel earned and satisfying?"
    applicable_to: [write_novel_chapter_arc, write_full_novel]
    severity: critical

  publication_ready:
    question: "Is this ready to submit to agents/publishers or self-publish?"
    applicable_to: [write_full_novel]
    severity: critical

# Validation Process Flow

validation_process:
  steps:
    - step: 1
      name: "Load validation config"
      action: "Read validator_config.yaml for creative domain"

    - step: 2
      name: "Identify deliverable type"
      action: "Determine which validation rules apply (scene, character, world, etc.)"

    - step: 3
      name: "Run automated checks"
      action: "Execute word count, spell check, formatting checks"

    - step: 4
      name: "Check completeness"
      action: "Verify all required story elements present"

    - step: 5
      name: "Validate story logic"
      action: "Check for plot holes, continuity errors, inconsistencies"

    - step: 6
      name: "Assess narrative quality"
      action: "Review prose quality, pacing, character voices"

    - step: 7
      name: "Check technical polish"
      action: "Verify grammar, spelling, punctuation, formatting"

    - step: 8
      name: "Apply manual checklist"
      action: "Review items requiring creative judgment"

    - step: 9
      name: "Classify result"
      action: "Determine PASS, FIXABLE, or BLOCKED based on findings"

    - step: 10
      name: "Write validation report"
      action: "Create validation_report.yaml with all findings"

# Domain-Specific Validation Notes

validation_notes: |
  Creative domain validation considerations:

  **Creative Quality is Subjective**:
  - Some quality aspects require judgment (engagement, emotional impact)
  - Use best judgment based on genre conventions and writing craft
  - When in doubt, err on side of quality over rigid rule enforcement
  - "Good enough" for tier 1-2, "professional" for tier 3-4

  **Word Count is Guideline**:
  - Word count targets are suggestions, not rigid requirements
  - Story needs determine appropriate length
  - Better to be slightly short and tight than long and padded
  - Epic fantasy can exceed upper word count limits if justified

  **Technical vs Creative Issues**:
  - Technical (grammar, spelling, formatting): Always FIXABLE
  - Creative (plot, character, voice): Often FIXABLE, sometimes BLOCKED
  - Fundamental story problems may require HITL creative direction
  - Surface fixes can't solve deep story issues

  **Iteration is Normal**:
  - First draft validation often finds many issues (expected)
  - Self-correction should resolve most technical and structural issues
  - Some creative issues may require multiple iterations
  - If 2-3 corrections don't improve, escalate to HITL

  **Genre Conventions**:
  - Validate against genre expectations
  - Romance needs satisfying romantic arc
  - Mystery needs fair clue placement
  - Fantasy needs consistent world rules
  - Sci-fi needs plausible speculation
  - Literary fiction needs thematic depth

  **Common Creative Deliverable Issues**:
  - Grammar/spelling errors (FIXABLE - copy-editor)
  - Plot holes (FIXABLE - continuity-checker + plot-developer)
  - Weak pacing (FIXABLE - editor)
  - Shallow characters (FIXABLE - character-psychologist)
  - Prose quality (FIXABLE - prose-stylist)
  - Inconsistent world rules (FIXABLE - worldbuilder)
  - Fundamental plot doesn't work (BLOCKED - needs creative direction)
  - Characters lack authenticity despite revision (BLOCKED - may need rethink)

  **Continuity is Critical**:
  - For multi-chapter or novel work, continuity errors break immersion
  - Check character names, appearances, abilities consistent
  - Check timeline makes sense
  - Check world rules applied consistently
  - continuity-checker agent specialized for this

  **Sensitivity and Representation**:
  - If work includes diverse identities, sensitivity review recommended
  - Respectful representation is quality requirement
  - Sensitivity concerns may require HITL judgment
  - Better to pause for sensitivity review than publish harmful content

  **Tier-Specific Standards**:
  - Tier 1: Clean prose, no major errors, serviceable quality
  - Tier 2: Professional quality prose, engaging, well-crafted
  - Tier 3: Consistently high quality, ready for serious readers
  - Tier 4: Publication-ready quality, professional polish throughout

  **When Creative Direction Needed**:
  - Fundamental story isn't working
  - Characters lack depth despite revision
  - Tone or voice unclear
  - Story lacks conflict or stakes
  - These require human creative judgment (BLOCKED)

  **Validation vs Critique**:
  - Validation checks minimum quality standards (pass/fail)
  - Critique provides subjective feedback for improvement
  - Both valuable but serve different purposes
  - Validation can be more systematic
  - Critique requires deeper creative engagement

  **Fixability Assessment**:
  - Technical errors: Always fixable
  - Structural errors (plot holes, continuity): Usually fixable
  - Quality issues (pacing, prose): Often fixable with skilled editing
  - Fundamental creative issues: May be fixable, may need HITL
  - Creative vision unclear: Requires HITL
