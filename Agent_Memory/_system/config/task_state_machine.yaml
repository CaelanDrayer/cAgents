# 10-State Task Lifecycle State Machine - Orchestration V2

states:
  PENDING:
    description: "Task created, not yet assigned"
    next_states: [IN_PLANNING, ASSIGNED, CANCELLED]
    owner: planner
    sla_target: "< 2 hours (tier 1-2), < 8 hours (tier 3-4)"
    
  IN_PLANNING:
    description: "Domain Lead breaking strategic task into tactical tasks"
    next_states: [ASSIGNED, CANCELLED]
    owner: domain_lead
    applicable_to: [tier_3, tier_4]
    sla_target: "< 1 day"
    
  ASSIGNED:
    description: "Task assigned to IC, not started"
    next_states: [IN_PROGRESS, CANCELLED, BLOCKED]
    owner: domain_lead
    sla_target: "< 4 hours"
    
  IN_PROGRESS:
    description: "IC actively working"
    next_states: [UNDER_REVIEW, BLOCKED, COMPLETED]
    owner: ic
    requires_heartbeat: every_4_hours
    sla_target: "per task estimate"
    
  BLOCKED:
    description: "IC cannot proceed"
    next_states: [ESCALATED, IN_PROGRESS, CANCELLED]
    owner: ic
    auto_escalate_after: "4 hours"
    sla_target: "< 2 hours"
    
  ESCALATED:
    description: "Blocker escalated to Domain Lead"
    next_states: [IN_PROGRESS, CANCELLED]
    owner: domain_lead
    sla_target: "< 8 hours"
    
  UNDER_REVIEW:
    description: "Peer code review"
    next_states: [DOMAIN_REVIEW, IN_PROGRESS]
    owner: peer_ic
    sla_target: "< 4 hours"
    
  DOMAIN_REVIEW:
    description: "Domain Lead final approval"
    next_states: [READY_FOR_HANDOFF, COMPLETED, IN_PROGRESS]
    owner: domain_lead
    sla_target: "< 8 hours"
    
  READY_FOR_HANDOFF:
    description: "Approved, waiting for cross-domain handoff"
    next_states: [COMPLETED]
    owner: domain_lead
    applicable_to: [tier_2, tier_3, tier_4]
    sla_target: "< 1 day"
    
  COMPLETED:
    description: "Task fully done"
    next_states: []
    terminal: true
    
  CANCELLED:
    description: "Task cancelled"
    next_states: []
    terminal: true
    requires_documentation: true

transition_rules:
  PENDING_to_IN_PLANNING:
    condition: "tier >= 3 AND task.type == 'strategic'"
    actor: orchestrator
    
  PENDING_to_ASSIGNED:
    condition: "tier <= 2 OR task.type == 'tactical'"
    actor: domain_lead
    
  ASSIGNED_to_IN_PROGRESS:
    condition: "IC has capacity AND dependencies met"
    actor: ic
    
  IN_PROGRESS_to_BLOCKED:
    condition: "IC encounters blocker"
    actor: ic
    auto_escalate: "after 4 hours"
    
  BLOCKED_to_ESCALATED:
    condition: "IC escalates OR auto-escalation triggered"
    actor: ic_or_system
    
  IN_PROGRESS_to_UNDER_REVIEW:
    condition: "IC completes work AND basic quality check passed"
    actor: ic
    
  UNDER_REVIEW_to_IN_PROGRESS:
    condition: "Peer requests changes"
    actor: peer_ic
    
  UNDER_REVIEW_to_DOMAIN_REVIEW:
    condition: "Peer approves"
    actor: peer_ic
    
  DOMAIN_REVIEW_to_IN_PROGRESS:
    condition: "Domain Lead requests changes"
    actor: domain_lead
    
  DOMAIN_REVIEW_to_READY_FOR_HANDOFF:
    condition: "Domain Lead approves AND cross-domain dependency exists"
    actor: domain_lead
    
  DOMAIN_REVIEW_to_COMPLETED:
    condition: "Domain Lead approves AND no cross-domain dependency"
    actor: domain_lead
    
  READY_FOR_HANDOFF_to_COMPLETED:
    condition: "Downstream domain acknowledges"
    actor: downstream_domain_lead

sla_escalation_rules:
  PENDING:
    warning_threshold: "2x target"
    escalation_threshold: "4x target"
    escalate_to: engineering_manager
    
  IN_PLANNING:
    warning_threshold: "1.5 days"
    escalation_threshold: "2 days"
    escalate_to: tech_lead
    
  ASSIGNED:
    warning_threshold: "8 hours"
    escalation_threshold: "24 hours"
    escalate_to: domain_lead
    
  IN_PROGRESS:
    warning_threshold: "1.5x estimated_effort"
    escalation_threshold: "2x estimated_effort"
    escalate_to: domain_lead
    
  BLOCKED:
    warning_threshold: "4 hours"
    escalation_threshold: "8 hours"
    escalate_to: tech_lead
    
  UNDER_REVIEW:
    warning_threshold: "8 hours"
    escalation_threshold: "24 hours"
    escalate_to: domain_lead
    
  DOMAIN_REVIEW:
    warning_threshold: "16 hours"
    escalation_threshold: "48 hours"
    escalate_to: tech_lead
    
  READY_FOR_HANDOFF:
    warning_threshold: "2 days"
    escalation_threshold: "3 days"
    escalate_to: tech_lead
