# Business Domain Validator Configuration
# Quality gates and validation rules for business deliverables

domain: business
version: 1.0
description: "Validation and quality gates for business operations, strategy, and analysis"

# Quality Gates
# Critical checks that must pass for deliverables

quality_gates:
  completeness:
    severity: critical
    description: "All required sections and components present"
    checks:
      - name: "All plan sections present"
        applicable_to: [strategic_plan, process_design, risk_assessment]
        pass_criteria: "Executive summary, analysis, recommendations, implementation plan all present"
        fixable: true
        fix_agent: business-analyst

      - name: "All data requirements met"
        applicable_to: [create_forecast, market_analysis, data_analysis]
        pass_criteria: "All required data sources accessed, no critical data gaps"
        fixable: true
        fix_agent: market-analyst

      - name: "All stakeholder input collected"
        applicable_to: [strategic_plan, process_design, budget_creation]
        pass_criteria: "Input from all identified stakeholders documented"
        fixable: true
        fix_agent: business-analyst
        escalate_if_missing: "C-level stakeholder input"

  data_quality:
    severity: critical
    description: "Data accuracy, sources, and validation"
    checks:
      - name: "All data sources cited"
        applicable_to: [market_analysis, create_forecast, business_case, data_analysis]
        pass_criteria: "Every data point has source attribution"
        fixable: true
        fix_agent: market-analyst
        common_issue: "Market data without source citation"

      - name: "Financial calculations verified"
        applicable_to: [create_forecast, budget_creation, business_case]
        pass_criteria: "All formulas correct, totals reconcile, no circular references"
        fixable: true
        fix_agent: business-analyst
        validation_method: "Manual review of formulas and cross-checks"

      - name: "Assumptions documented"
        applicable_to: [create_forecast, strategic_plan, business_case]
        pass_criteria: "All key assumptions explicitly stated and justified"
        fixable: true
        fix_agent: business-analyst

      - name: "Data recency acceptable"
        applicable_to: [market_analysis, competitive_analysis]
        pass_criteria: "Data no older than acceptable threshold (varies by type)"
        fixable: true
        fix_agent: market-analyst
        thresholds:
          market_data: "< 6 months old"
          financial_data: "< 3 months old"
          competitive_data: "< 3 months old"

  format_compliance:
    severity: major
    description: "Professional formatting and corporate standards"
    checks:
      - name: "Executive summary present"
        applicable_to: [strategic_plan, market_analysis, business_case]
        pass_criteria: "1-2 page executive summary at beginning"
        fixable: true
        fix_agent: business-analyst

      - name: "Professional formatting"
        applicable_to: all
        pass_criteria: "Proper headings, no typos, consistent formatting, corporate template used"
        fixable: true
        fix_agent: business-analyst
        validation_method: "Manual review for professionalism"

      - name: "Visual aids appropriate"
        applicable_to: [market_analysis, strategic_plan, stakeholder_communication]
        pass_criteria: "Charts, graphs, tables used where appropriate, properly labeled"
        fixable: true
        fix_agent: business-analyst

      - name: "Length appropriate"
        applicable_to: all
        pass_criteria: "Deliverable length matches expectations (not too brief, not excessive)"
        fixable: true
        fix_agent: business-analyst
        guidelines:
          executive_summary: "1-2 pages"
          market_analysis: "10-20 pages"
          strategic_plan: "15-30 pages"
          forecast: "5-10 pages"

  stakeholder_approval:
    severity: critical
    description: "Required stakeholder sign-offs obtained"
    checks:
      - name: "Department head approval"
        applicable_to: [budget_creation, process_design]
        when: "tier >= 2"
        pass_criteria: "Affected department heads reviewed and approved"
        fixable: false  # Requires HITL
        escalate_to: hitl

      - name: "C-level approval"
        applicable_to: [strategic_plan, budget_creation]
        when: "tier >= 3 OR budget > $1M"
        pass_criteria: "Appropriate C-level executive reviewed and approved"
        fixable: false  # Requires HITL
        escalate_to: hitl

      - name: "Board approval"
        applicable_to: [strategic_plan]
        when: "tier = 4"
        pass_criteria: "Board of directors reviewed and approved"
        fixable: false  # Requires HITL
        escalate_to: hitl

  accuracy:
    severity: major
    description: "Factual correctness and logical consistency"
    checks:
      - name: "No internal contradictions"
        applicable_to: all
        pass_criteria: "No statements that contradict each other"
        fixable: true
        fix_agent: business-analyst
        validation_method: "Manual review for logical consistency"

      - name: "Recommendations supported by analysis"
        applicable_to: [strategic_plan, market_analysis, business_case]
        pass_criteria: "Every recommendation has supporting analysis/data"
        fixable: true
        fix_agent: business-analyst

      - name: "Financial projections realistic"
        applicable_to: [create_forecast, business_case]
        pass_criteria: "Projections align with historical trends and market conditions"
        fixable: true
        fix_agent: business-analyst
        common_issue: "Overly optimistic growth assumptions"

  actionability:
    severity: major
    description: "Deliverable provides clear next steps"
    checks:
      - name: "Implementation plan included"
        applicable_to: [strategic_plan, process_design]
        pass_criteria: "Clear timeline, milestones, responsibilities, resources defined"
        fixable: true
        fix_agent: project-manager

      - name: "Decisions clearly stated"
        applicable_to: all
        pass_criteria: "What decisions need to be made is explicit"
        fixable: true
        fix_agent: business-analyst

      - name: "Next steps defined"
        applicable_to: all
        pass_criteria: "Clear action items with owners and dates"
        fixable: true
        fix_agent: business-analyst

# Validation Rules
# Domain-specific validation logic

validation_rules:
  forecast_validation:
    applicable_to: [create_forecast]
    required_components:
      - "Historical data section (minimum 2 years)"
      - "Trend analysis"
      - "Minimum 3 scenarios (optimistic, realistic, pessimistic)"
      - "Assumptions section"
      - "Forecast methodology explanation"
      - "Executive summary"
    data_quality_requirements:
      - "All historical data sourced and cited"
      - "Scenario assumptions clearly differentiated"
      - "Formulas verified for correctness"
    format_requirements:
      - "Excel model interactive and documented"
      - "Charts for scenario comparison"
      - "Summary table with key metrics"

  strategic_plan_validation:
    applicable_to: [strategic_plan]
    required_components:
      - "Current state analysis"
      - "Market analysis"
      - "Strategic objectives (SMART format)"
      - "Implementation roadmap with timeline"
      - "Resource requirements"
      - "Success metrics/KPIs"
      - "Risk assessment"
      - "Executive summary"
    stakeholder_requirements:
      - "C-level approval obtained"
      - "Key stakeholder input documented"
    format_requirements:
      - "Professional presentation deck created"
      - "Detailed planning document created"
      - "Roadmap visual (Gantt chart or timeline)"

  market_analysis_validation:
    applicable_to: [market_analysis]
    required_components:
      - "Market size and trends"
      - "Competitive landscape"
      - "Customer segments"
      - "Key insights and implications"
      - "Recommendations"
      - "Data sources and methodology"
      - "Executive summary"
    data_quality_requirements:
      - "All market data sources cited"
      - "Data recency acceptable (< 6 months)"
      - "Competitive intelligence sourced"
    format_requirements:
      - "Visual market landscape map"
      - "Competitor comparison matrix"
      - "Trend charts"

  process_design_validation:
    applicable_to: [process_design]
    required_components:
      - "Current process documentation (as-is)"
      - "Gap analysis / pain points"
      - "Future process design (to-be)"
      - "Process flow diagrams for both"
      - "Stakeholder validation documented"
      - "Implementation plan"
      - "Training materials or plan"
    stakeholder_requirements:
      - "Affected department heads reviewed"
      - "Process users consulted"
    format_requirements:
      - "Process maps created (visual diagrams)"
      - "Documentation follows corporate template"
      - "Side-by-side comparison of old vs new"

  budget_creation_validation:
    applicable_to: [budget_creation]
    required_components:
      - "Budget requirements from all stakeholders"
      - "Historical spend analysis"
      - "Budget allocation with business rationale"
      - "Budget model (interactive spreadsheet)"
      - "Department head approvals"
      - "Variance analysis vs. previous period"
    data_quality_requirements:
      - "All allocations justified"
      - "Formulas verified"
      - "Totals reconcile"
    format_requirements:
      - "Excel model with sensitivity analysis"
      - "Summary presentation for executives"
      - "Department-level breakdown"

  risk_assessment_validation:
    applicable_to: [risk_assessment]
    required_components:
      - "Comprehensive risk identification"
      - "Risk likelihood and impact assessment"
      - "Risk prioritization (risk matrix)"
      - "Mitigation strategies for high-priority risks"
      - "Risk register with ownership"
      - "Monitoring plan"
    data_quality_requirements:
      - "Risk assessment framework clearly stated"
      - "All high risks have mitigation plans"
    format_requirements:
      - "Risk matrix visual"
      - "Risk register spreadsheet"
      - "Executive summary of top risks"

  business_case_validation:
    applicable_to: [business_case]
    required_components:
      - "Problem statement / opportunity"
      - "Options analysis (including do-nothing)"
      - "Financial analysis (ROI, NPV, payback)"
      - "Non-financial benefits"
      - "Risks and dependencies"
      - "Implementation approach"
      - "Recommendation with rationale"
    data_quality_requirements:
      - "All cost and benefit assumptions documented"
      - "Financial calculations verified"
      - "Sensitivity analysis included"
    format_requirements:
      - "Excel financial model"
      - "Executive summary (1-2 pages)"
      - "Recommendation clearly highlighted"

  vendor_evaluation_validation:
    applicable_to: [vendor_evaluation]
    required_components:
      - "Evaluation criteria defined upfront"
      - "Vendor scorecard (all vendors rated consistently)"
      - "Reference checks documented"
      - "Pricing comparison"
      - "Risk assessment for each vendor"
      - "Recommendation with rationale"
    data_quality_requirements:
      - "Scoring methodology documented"
      - "All vendors evaluated on same criteria"
      - "References verified"
    format_requirements:
      - "Comparison matrix or scorecard"
      - "Executive summary with recommendation"

# Classification Criteria
# How to classify validation outcomes

classification:
  PASS:
    description: "Deliverable meets all requirements, ready for handoff/approval"
    criteria:
      all_critical_passed: true
      all_major_passed: true
      minor_issues_count: "<= 2"
      stakeholder_approvals_obtained: true  # If required for tier
    next_action: "Mark instruction as completed"

  FIXABLE:
    description: "Issues found but can be corrected without HITL"
    criteria:
      any_critical_failed: true
      issue_types: [missing_data, formatting, assumptions_not_documented, citations_missing]
      fixable: true
      retry_count: "< max_retries"
    next_action: "Send to self-correct agent"
    common_fixable_issues:
      - "Missing data sources / citations"
      - "Assumptions not documented"
      - "Formatting issues (typos, template compliance)"
      - "Missing executive summary"
      - "Incomplete analysis sections"
      - "Calculations need verification"
      - "Visual aids missing or inadequate"

  BLOCKED:
    description: "Cannot proceed without human intervention"
    criteria:
      stakeholder_approval_required: true
      stakeholder_approval_missing: true
    OR:
      critical_data_unavailable: true
      data_source_inaccessible: true
    OR:
      fundamental_methodology_issue: true
    OR:
      retry_count: ">= max_retries"
    next_action: "Escalate to HITL"
    common_blocking_issues:
      - "Stakeholder approval required but not obtained"
      - "Critical data source unavailable"
      - "Conflicting stakeholder requirements"
      - "Fundamental assumptions challenged"
      - "External dependency blocking progress"
      - "Self-correction attempts exhausted"

# Automated Validation Checks
# Checks that can be run automatically

automated_checks:
  word_count:
    description: "Verify deliverable meets minimum length requirements"
    command: "wc -w {output_file}"
    pass_criteria:
      executive_summary: ">= 500 words AND <= 2000 words"
      market_analysis: ">= 2000 words"
      strategic_plan: ">= 3000 words"
    fixable: true

  spell_check:
    description: "No spelling errors in deliverable"
    command: "aspell -c {output_file}"
    pass_criteria: "No misspellings found"
    fixable: true
    severity: major

  link_validation:
    description: "All links and references valid"
    command: "grep -o 'http[s]*://[^)]*' {output_file} | xargs -I {} curl -I {}"
    pass_criteria: "All URLs return 200 status"
    fixable: true
    severity: minor

  file_format_check:
    description: "Deliverable in correct format"
    applicable_to:
      forecast: [".xlsx", ".xlsm"]
      presentation: [".pptx", ".pdf"]
      document: [".docx", ".pdf"]
    pass_criteria: "File extension matches expected format"
    fixable: false
    severity: critical

# Manual Validation Checklist
# Items requiring human judgment

manual_validation_checklist:
  professional_tone:
    question: "Is the tone professional and appropriate for the audience?"
    applicable_to: all
    severity: major

  executive_ready:
    question: "Is this ready to present to executives without further polish?"
    applicable_to: [strategic_plan, stakeholder_communication, business_case]
    severity: major

  data_credibility:
    question: "Are data sources credible and appropriate?"
    applicable_to: [market_analysis, create_forecast, business_case]
    severity: critical

  recommendations_actionable:
    question: "Can stakeholders act on these recommendations?"
    applicable_to: [strategic_plan, market_analysis, business_case]
    severity: major

  visual_quality:
    question: "Are charts, graphs, and visuals professional quality?"
    applicable_to: all
    severity: major

# Validation Process Flow

validation_process:
  steps:
    - step: 1
      name: "Load validation config"
      action: "Read validator_config.yaml for business domain"

    - step: 2
      name: "Identify deliverable type"
      action: "Determine which validation rules apply based on intent"

    - step: 3
      name: "Run automated checks"
      action: "Execute all applicable automated validation checks"

    - step: 4
      name: "Check required components"
      action: "Verify all required sections present"

    - step: 5
      name: "Validate data quality"
      action: "Check citations, assumptions, calculations"

    - step: 6
      name: "Check format compliance"
      action: "Verify professional formatting and corporate templates"

    - step: 7
      name: "Verify stakeholder approvals"
      action: "If tier 3-4, confirm required approvals obtained"

    - step: 8
      name: "Apply manual checklist"
      action: "Review manual validation items requiring judgment"

    - step: 9
      name: "Classify result"
      action: "Determine PASS, FIXABLE, or BLOCKED based on findings"

    - step: 10
      name: "Write validation report"
      action: "Create validation_report.yaml with all findings"

# Domain-Specific Validation Notes

validation_notes: |
  Business domain validation considerations:

  **Professional Polish is Critical**:
  - Typos or formatting errors can derail executive approval
  - Corporate templates must be used consistently
  - Visual quality matters (charts, graphs, tables)
  - Tone must match audience (board vs department vs team)

  **Data Quality is Non-Negotiable**:
  - Every data point must have source attribution
  - Financial calculations must be verified
  - Assumptions must be explicit and justified
  - Outdated data (>6 months for market) should be flagged

  **Stakeholder Approval Gates**:
  - Tier 3-4 often require C-level or board approval
  - Missing approvals = BLOCKED, not FIXABLE
  - HITL must coordinate approval process
  - Budget approvals have dollar thresholds

  **Completeness Before Polish**:
  - Check for required sections first (executive summary, recommendations, etc.)
  - Missing sections are FIXABLE (agent can add)
  - Missing data may be BLOCKED if source unavailable
  - Missing stakeholder input may require HITL

  **Common Business Deliverable Issues**:
  - Missing executive summary (FIXABLE - business-analyst adds)
  - Data sources not cited (FIXABLE - market-analyst adds citations)
  - Assumptions not documented (FIXABLE - business-analyst documents)
  - Typos or formatting errors (FIXABLE - business-analyst polishes)
  - Missing stakeholder approval (BLOCKED - requires HITL)
  - Conflicting stakeholder requirements (BLOCKED - requires HITL to resolve)
  - Fundamental methodology issues (BLOCKED - requires rework with HITL guidance)

  **Validation vs Review**:
  - Validation checks minimum quality standards (pass/fail)
  - Review provides qualitative feedback for improvement
  - Both are important but serve different purposes
  - Validation can be automated or checklist-driven
  - Review requires business judgment and expertise

  **Self-Correction Readiness**:
  - Most formatting and completeness issues are FIXABLE
  - Self-correct agent can invoke business-analyst to add missing sections
  - Self-correct agent can invoke market-analyst to add citations
  - Data unavailability or stakeholder conflicts require HITL

  **Tier-Specific Validation**:
  - Tier 1-2: Focus on completeness and accuracy
  - Tier 3: Add format compliance and stakeholder approvals
  - Tier 4: Strict requirements for all gates, multiple approval levels

  **Iteration Expectation**:
  - First validation pass often finds issues (normal)
  - Self-correction should resolve most issues
  - If 2-3 self-correction attempts fail, escalate to HITL
  - Some iteration is expected in business work
